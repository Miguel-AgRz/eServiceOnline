var eServiceOnline=eServiceOnline||{};eServiceOnline.Site=function(n,t){this.listUrl=n;this.processContextMenuUrl=t};eServiceOnline.Site.Instance=new eServiceOnline.Site;eServiceOnline.Site.prototype.MergeStyledCell=function(n){n.data[n.column.field]!==null?($(n.cell).addClass(n.data[n.column.field].Style),$(n.cell).text(n.data[n.column.field].PropertyValue),$("table th div").removeClass("e-gridtooltip"),n.data[n.column.field].IsNeedRowMerge===!0&&n.rowMerge(n.data[n.column.field].RowMergeNumber),$(n.cell).css({padding:"0.3em"}),$(document).delegate(n.cell,"contextmenu",function(n){n.preventDefault()}),$("#matchDialog").hide(),$(n.cell).mousedown(function(t){var i,s,r,u,o,h,f,e;if(($("#tipContent").hide(),$(n.cell).parent("tr").removeAttr("aria-selected"),i=n.data[n.column.field].ContextMenus,$("table td").removeClass("e-cellselectionbackground e-activecell"),$(n.cell).addClass("e-cellselectionbackground e-activecell"),i!==null)&&3===t.which&&($("#tipContent").html(""),i.length>0)){for(s='<div style="margin-left: 10px; margin-right:10px; height: 0; border: 1px solid #AE4B68;"><\/div>',$("#tipContent").append(" <div style='border-top:4px solid #AE4B68;'><\/div>"),r=0;r<i.length;r++){if(u="",i[r].ProcessingMode===2)u=i[r].ControllerName!==null&&i[r].ActionName!==null?i[r].IsHaveSplitLine===!0&&i.length>1?i[r].IsDisabled===!0?s+"<div> <a class='disableMenuStyle'>"+i[r].MenuName+"<\/a>  <\/div>":s+"<div> <a class='contextMenuStyle' onclick='siteInstance.PopsUpWindow("+JSON.stringify(i[r])+")' >"+i[r].MenuName+"<\/a><\/div>":i[r].IsDisabled===!0?"<div> <a class='disableMenuStyle' >"+i[r].MenuName+"<\/a>  <\/div>":"<div> <a class='contextMenuStyle' onclick='siteInstance.PopsUpWindow("+JSON.stringify(i[r])+")' >"+i[r].MenuName+"<\/a><\/div>":i[r].IsHaveSplitLine===!0&&i.length>1?i[r].IsDisabled===!0?s+" <div> <a class='disableMenuStyle' >"+i[r].MenuName+"<\/a>  <\/div>":s+" <div> <a class='contextMenuStyle' >"+i[r].MenuName+"<\/a>  <\/div>":i[r].IsDisabled===!0?" <div> <a class='disableMenuStyle' >"+i[r].MenuName+"<\/a>  <\/div>":" <div> <a class='contextMenuStyle'  >"+i[r].MenuName+"<\/a>  <\/div>";else if(i[r].ProcessingMode===1)u=i[r].IsHaveSplitLine===!0&&i.length>1?i[r].IsDisabled===!0?s+" <div> <a class='disableMenuStyle'  >"+i[r].MenuName+"<\/a>  <\/div>":s+" <div> <a class='contextMenuStyle'  onclick='siteInstance.NoPopsUpWindow("+JSON.stringify(i[r])+")' >"+i[r].MenuName+"<\/a>  <\/div>":i[r].IsDisabled===!0?" <div> <a class='disableMenuStyle' >"+i[r].MenuName+"<\/a>  <\/div>":" <div> <a class='contextMenuStyle'  onclick='siteInstance.NoPopsUpWindow("+JSON.stringify(i[r])+")' >"+i[r].MenuName+"<\/a>  <\/div>";else if(i[r].ProcessingMode===3)if(console.log(i[r]),i[r].IsDisabled===!0)if(u=" <div> <a class='disableMenuStyle' >"+i[r].MenuName+"<\/a>  <\/div>",i[r].MenuList!=null&&i[r].MenuList.length>0){for(u="<div class=\"cellmenu\"> <a class='disableMenuStyle'>"+i[r].MenuName+"<\/a>",u=u+'<i class="e-icon e-arrow-sans-right showcellmenu"><\/i> <ul>',o=0;o<i[r].MenuList.length;o++){if(u=u+"<li><a class='disableMenuStyle' >"+i[r].MenuList[o].MenuName.replace(new RegExp("%%%","g"),"'")+"<\/a>",i[r].MenuList[o].MenuList!=null&&i[r].MenuList[o].MenuList.length>0){for(u=u+"<i class='e-icon e-arrow-sans-right showcellmenu'><\/i><ul>",h=0;h<i[r].MenuList[o].MenuList.length;h++)u=u+"<li><a class='disableMenuStyle' >"+i[r].MenuList[o].MenuList[h].MenuName.replace(new RegExp("%%%","g"),"'")+"<\/a><\/li>";u=u+"<\/ul>"}u=u+"<\/li>"}u=u+"<\/ul> <\/div>"}else u=" <div> <a class='disableMenuStyle' >"+i[r].MenuName+"<\/a>  <\/div>";else if(i[r].MenuList!=null&&i[r].MenuList.length>0){for(u="<div class=\"cellmenu\"> <a class='contextMenuStyle'>"+i[r].MenuName+"<\/a>",u=u+'<i class="e-icon e-arrow-sans-right showcellmenu"><\/i> <ul>',f=0;f<i[r].MenuList.length;f++){if(i[r].MenuList[f].IsDisabled===!0?u=u+"<li><a class='disableMenuStyle' >"+i[r].MenuList[f].MenuName.replace(new RegExp("%%%","g"),"'")+"<\/a>":i[r].MenuList[f].ProcessingMode===2?u=u+"<li><a class='contextMenuStyle' onclick='siteInstance.PopsUpWindow("+JSON.stringify(i[r].MenuList[f])+")' >"+i[r].MenuList[f].MenuName.replace(new RegExp("%%%","g"),"'")+"<\/a>":i[r].MenuList[f].ProcessingMode===1&&(u=u+"<li><a class='contextMenuStyle' onclick='siteInstance.NoPopsUpWindow("+JSON.stringify(i[r].MenuList[f])+")' >"+i[r].MenuList[f].MenuName.replace(new RegExp("%%%","g"),"'")+"<\/a>"),i[r].MenuList[f].MenuList!=null&&i[r].MenuList[f].MenuList.length>0){for(u=u+"<i class='e-icon e-arrow-sans-right showcellmenu'><\/i><ul>",e=0;e<i[r].MenuList[f].MenuList.length;e++)u=i[r].MenuList[f].MenuList[e].IsDisabled===!0?u+"<li><a class='disableMenuStyle' >"+i[r].MenuList[f].MenuList[e].MenuName.replace(new RegExp("%%%","g"),"'")+"<\/a><\/li>":i[r].MenuList[f].MenuList[e].ProcessingMode===2?u+"<li><a class='contextMenuStyle' onclick='siteInstance.PopsUpWindow("+JSON.stringify(i[r].MenuList[f].MenuList[e])+")' >"+i[r].MenuList[f].MenuList[e].MenuName.replace(new RegExp("%%%","g"),"'")+"<\/a><\/li>":i[r].MenuList[f].MenuList[e].ProcessingMode===1?u+"<li><a class='contextMenuStyle' onclick='siteInstance.NoPopsUpWindow("+JSON.stringify(i[r].MenuList[f].MenuList[e])+")' >"+i[r].MenuList[f].MenuList[e].MenuName.replace(new RegExp("%%%","g"),"'")+"<\/a><\/li>":u+"<li><a class='disableMenuStyle' >"+i[r].MenuList[f].MenuList[e].MenuName.replace(new RegExp("%%%","g"),"'")+"<\/a><\/li>";u=u+"<\/ul>"}u=u+"<\/li>"}u=u+"<\/ul> <\/div>"}else u=" <div> <a class='disableMenuStyle' >"+i[r].MenuName+"<\/a>  <\/div>";else u=i[r].IsDisabled===!0?" <div> <a class='disableMenuStyle' >"+i[r].MenuName+"<\/a>  <\/div>":" <div> <a class='contextMenuStyle' >"+i[r].MenuName+"<\/a>  <\/div>";$("#tipContent").append(u)}var a=$(window).width(),v=$(window).height(),c=$("#tipContent").width(),l=$("#tipContent").height(),y=t.clientY+20>v-l?t.clientY-l>0?t.clientY-l:0:t.clientY+20,p=t.clientX-20>a-c?t.clientX-c>0?t.clientX-c:0:t.clientX-20;$("#tipContent").css({top:y,left:p,display:"block"});$("#tipContent").on("mouseleave",function(){$(this).hide()});$(".showcellmenu").on("mouseover",function(){$(this).parent().siblings().find(".showcellmenu").next().hide();var i=$(this).next("ul").width(),n=$(this).next("ul").height(),t=$(this).parent().offset().top,u=$(this).parent().offset().left,r=$(this).parent().width(),f=v-t>n?0:n>t?50-t:36-n,e=a-u-r>i?r:-i;$(this).next("ul").css({top:f,left:e,display:"block"});$(this).next("ul").show()});$(".showcellmenu +ul").on("mouseleave",function(){$(this).hide()})}})):$(n.cell).text(n.data[n.column.field])};eServiceOnline.Site.prototype.switchMenu=function(){var n=window.location.pathname.split("/"),t=n[1];$.each({upcomingJobs:["headerUpcomingJobs","UpcomingJobs"],productHaul:["headerProductHaul","ProductHaul"],rigBoard:["headerRigBoard","RigBoard"],bulkPlant: ["headerBulkPlant", "BulkPlant"],CrewBoard:["headerResource","Resource"],Calendar:["headerCalendar","Calendar"]},function(n,i){$.inArray(t,i)!==-1&&$("#"+i[0]).addClass("active").siblings().removeClass("active")})};eServiceOnline.Site.prototype.switchMenu();eServiceOnline.Site.prototype.NoPopsUpWindow=function(n){var t=this.processContextMenuUrl;$.ajax({url:t,method:"Post",data:n,success:function(n){console.log(n===!0);n===!0?window.location.reload():alert("Operation fail.")}})};eServiceOnline.Site.prototype.PopsUpWindow=function(n){console.log(n);var t=this.processContextMenuUrl;$.ajax({url:t,method:"Post",data:n,success:function(t){$("#tipContent").hide();$(".sj_mask").fadeIn(300,function(){$("#basicDialog_title span").html(n.MenuName.replace(new RegExp("%%%","g"),"'"));$("#basicDialog").html(t);$("#basicDialog").ejDialog("open")})}})};eServiceOnline.Site.prototype.CloseDialog=function(){$(".sj_mask").fadeOut(300,function(){$("#basicDialog").ejDialog("close")})};